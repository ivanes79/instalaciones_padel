-- Borra la base de datos si existe y si no existe no hace nada.
DROP DATABASE IF EXISTS INSTALACIONPADEL;

-- Crea la base de datos.
CREATE DATABASE INSTALACIONPADEL DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;

-- Lo que hay despu√©s( CREATE TABLE.... ) se realizan sobre la base de datos de USE.
USE INSTALACIONPADEL;

CREATE TABLE `1000_ESCUELASPADEL` (
     1000_idescuela TINYINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
	 1000_nomescuela CHAR( 50 ) NOT NULL,
	 1000_nif CHAR( 10 ) NOT NULL,
	 1000_feccreacion DATE NOT NULL,
	 1000_fotonomescuela CHAR( 100 ) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;


CREATE TABLE `2000_PROFESORES` (
     2000_idprofesor TINYINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
	 2000_nomprofesor CHAR ( 50 ) NOT NULL,
	 2000_nomfotoprofesor CHAR ( 100 ) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;


CREATE TABLE `3000_NIVELES` (
     3000_idnivel TINYINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
	 3000_nomnivel CHAR( 30 ) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE `4000_HORARIOS` (
     4000_idhorario TINYINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
	 4000_horario CHAR( 15 ) NOT NULL -- "9:00-9:30-10:00.."
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;



CREATE TABLE `1100_INSTALACIONESPADEL` (
     1100_idinstalacion TINYINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
	 1100_nominstalacion CHAR( 40 ) NOT NULL,
	 1100_direccion CHAR( 50 ) NOT NULL,
	 1100_telefono CHAR( 12 ) NOT NULL,
	 1100_fecapertura DATE NOT NULL,
	 1100_logoinstalacion CHAR( 100 ) NOT NULL,
	 1000_idescuela TINYINT UNSIGNED NOT NULL,
	 CONSTRAINT `fk_1100_INSTALACIONESPADEL_idescuela` FOREIGN KEY ( 1000_idescuela ) REFERENCES 1000_ESCUELASPADEL ( 1000_idescuela )
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE `3100_CLIENTES` (
     3100_idcliente SMALLINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
	 3100_nomcliente CHAR ( 40 ) NOT NULL,
	 3100_numtelefono CHAR( 12 ) NOT NULL,
	 3000_idnivel TINYINT UNSIGNED NOT NULL,
	 CONSTRAINT `fk_3100_CLIENTES_idnivel` FOREIGN KEY ( 3000_idnivel ) REFERENCES 3000_NIVELES ( 3000_idnivel )
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;


CREATE TABLE `3110_FOTOCLIENTES` (
     3100_idcliente SMALLINT UNSIGNED PRIMARY KEY,
	 3110_nomficherofoto CHAR( 100 ) NOT NULL,
	 CONSTRAINT `fk_3110_FOTOCLIENTES_idcliente` FOREIGN KEY ( 3100_idcliente ) REFERENCES 3100_CLIENTES ( 3100_idcliente )
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE `1110_PISTAS` (
	 1110_idpista TINYINT UNSIGNED AUTO_INCREMENT UNIQUE,
     1100_idinstalacion TINYINT UNSIGNED, 
	 PRIMARY KEY ( 1110_idpista, 1100_idinstalacion ),
	 CONSTRAINT `fk_1110_PISTAS_idinstalacion` FOREIGN KEY ( 1100_idinstalacion ) REFERENCES 1100_INSTALACIONESPADEL ( 1100_idinstalacion ),
	 1110_numpista CHAR( 20 ) NOT NULL,
	 1110_preciohorapista FLOAT( 5,2 ) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE `1111_CURSOS` (
     1111_idcurso SMALLINT UNSIGNED AUTO_INCREMENT UNIQUE,
	 1100_idinstalacion TINYINT UNSIGNED,
	 1110_idpista TINYINT UNSIGNED,
	 PRIMARY KEY ( 1111_idcurso, 1100_idinstalacion,1110_idpista ),
	 CONSTRAINT `fk_1111_CURSOS_1100_idinstalacion_1110_idpista` FOREIGN KEY ( 1100_idinstalacion, 1110_idpista ) REFERENCES 1110_PISTAS ( 1100_idinstalacion, 1110_idpista ),
	 1111_preciocurso FLOAT( 5,2 )UNSIGNED NOT NULL,
	 2000_idprofesor TINYINT UNSIGNED NOT NULL,
	 CONSTRAINT `fk_1111_CURSOS_2000_idprofesor` FOREIGN KEY ( 2000_idprofesor ) REFERENCES 2000_PROFESORES ( 2000_idprofesor ),
	 3000_idnivel TINYINT UNSIGNED NOT NULL,
	 CONSTRAINT `fk_1111_CURSOS_3000_idnivel` FOREIGN KEY ( 3000_idnivel ) REFERENCES 3000_NIVELES ( 3000_idnivel )
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE `4111_HORARIOSCURSOS` (
	 1111_idcurso SMALLINT UNSIGNED,
     4111_fecalta DATE,
	 4000_idhorario TINYINT UNSIGNED,
	 PRIMARY KEY ( 1111_idcurso, 4111_fecalta, 4000_idhorario ),
	 CONSTRAINT `fk_4111_HORARIOSCURSOS_1111_idcurso` FOREIGN KEY ( 1111_idcurso ) REFERENCES 1111_CURSOS ( 1111_idcurso ),
	 CONSTRAINT `fk_4111_HORARIOSCURSOS_4000_idhorario` FOREIGN KEY ( 4000_idhorario ) REFERENCES 4000_HORARIOS ( 4000_idhorario )
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;



CREATE TABLE `3120_REGISTROCLIENTES` (
	 1100_idinstalacion TINYINT UNSIGNED,
     3100_idcliente SMALLINT UNSIGNED,
	 PRIMARY KEY ( 1100_idinstalacion, 3100_idcliente ),
	 CONSTRAINT `fk_3120_REGISTROCLIENTES_1100_idinstalacion` FOREIGN KEY ( 1100_idinstalacion ) REFERENCES 1100_INSTALACIONESPADEL ( 1100_idinstalacion ),
	 CONSTRAINT `fk_3120_REGISTROCLIENTES_3100_idcliente` FOREIGN KEY ( 3100_idcliente ) REFERENCES 3100_CLIENTES ( 3100_idcliente ),
	 3120_fecregistro DATE NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;



CREATE TABLE `1111A_REGISTROSCURSOS` (
	 1111_idcurso SMALLINT UNSIGNED,
     3100_idcliente SMALLINT UNSIGNED,
	 1100_idinstalacion TINYINT UNSIGNED NOT NULL,
	 PRIMARY KEY ( 1111_idcurso, 3100_idcliente ),
	 CONSTRAINT `fk_1111A_REGISTROSCURSOS_1111_idcurso_1100_idinstalacion` FOREIGN KEY ( 1111_idcurso, 1100_idinstalacion ) REFERENCES 1111_CURSOS ( 1111_idcurso, 1100_idinstalacion ),
	 CONSTRAINT `fk_1111A_REGISTROSCURSOS_3100_idcliente_1100_idinstalacion` FOREIGN KEY ( 3100_idcliente, 1100_idinstalacion ) REFERENCES 3120_REGISTROCLIENTES ( 3100_idcliente, 1100_idinstalacion ),	 
	 1111A_fecinicio DATE NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;


